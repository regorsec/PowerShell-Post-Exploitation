# PowerShell Script to find anydesk.exe location, then start anydesk with unattended access using a custom password, add --nosession to prevent any user interface from executing.

# Search the current user directory
$folder = "$env:USERPROFILE\"

Get-ChildItem -Path $folder -Recurse -Filter "AnyDesk.exe" -ErrorAction SilentlyContinue |
ForEach-Object {
    $path = $_.FullName
    $args = "--unattended --no-session --set-password TestingPass"

    # Execute command
    & $path $args

    Write-Host "AnyDesk.exe executed. File Path: $path"
}

# Next, close the AnyDesk window we probably just opened. (Because --no-session isn't working..)

# Need to wait until windows are loaded
Start-Sleep 5

# Close Window(s)
(Get-Process -Name AnyDesk).CloseMainWindow()

