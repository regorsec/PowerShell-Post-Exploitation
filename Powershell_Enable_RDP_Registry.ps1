# PowerShell script to enable Remote RDP sessions via Registry 

# Tested: Windows 11, in 2023

# Define the registry path and key
$path = "HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server"
$key = "fDenyTSConnections"

# Retrieve the value of the key
$value = Get-ItemProperty -Path $path -Name $key

# Output the value
Write-Host "The value of $key is $($value.$key)"

# If value is 1, make it a 0 to enable remote connections
if ($value.$key -eq 1) {

    Set-ItemProperty $path -Name $key -Value 0
}
